<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <style>
        body {
    font-family: Arial, sans-serif;
    margin: 20px; 
    padding: 20px;
    line-height: 1.5;
    text-align: justify;
}

@media (min-width: 768px) {
    body {
        margin: 20px 100px; 
    }
}

@media (min-width: 1024px) {
    body {
        margin: 20px 400px; 
    }
}

        section {
            margin-bottom: 50px; 
        }

        @media (max-width: 768px) {
            section {
                margin-bottom: 30px; 
            }
        }

        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        code {
            font-family: "Cascadia Code", monospace;
            color: #11611d;
        }
        img {
        width: 80%;  
        height: auto;  
        display: block; 
        border: 1px solid #030303;
        }
        .author-box {
    background-color: #f0f0f0;  /* Light gray background */
    padding: 0px 10px;
    border-left: 5px solid #0073e6; /* Blue accent border */
    font-size: 16px;
    display: inline-block; /* Keeps box size close to content */
    margin-top: 10px; /* Space below the title */
}


    </style>
    <title>Automating Jupyter Notebooks with Papermill</title>
</head>
<body>
    <h1><strong>Automating Jupyter Notebooks with Papermill</strong></h1>
<section><div class="author-box">
        <p><strong>Authors:</strong> Ayush Alhat, Guransh Saran, Himani Goel</p>
    </div>
    <p><strong>Date:</strong> February 25, 2025</p>    
</section>

    <section id="introduction">
    <h2>Introduction</h2>
    <p>In the world of data science and automation, running Jupyter Notebooks manually can be repetitive and time-consuming, especially when working with different datasets or parameters. This is where <strong>Papermill</strong> comes in!
    <p>Papermill is an open-source Python library that allows you to:</p>
    <ul> 
        <li> Parameterize Jupyter Notebooks (pass different values without editing the code).</li>
        <li> Execute Notebooks programmatically (automate repetitive tasks).</li>
        <li> Track and log executions (useful for debugging and reproducibility).</li>
    </ul>    
    <p>With Papermill, you can efficiently run the same notebook multiple times with different inputs, making it a powerful tool for data pipelines, automated reporting, and machine learning workflows.</p>
    </section>
    
    <section id="installation">
    <h2>Installation & Setup of Papermill</h2>
    
    <i><h4> 1. Install Papermill using pip</h4></i>
    <p>Papermill is a Python library, so you can install it using <code>pip</code>:</p>
    <pre><code>pip install papermill</code></pre>
    
    <i><h4> 2. Verify the Installation</h4></i>
    <p>After installation, check if Papermill is installed correctly by running:</p>
    <pre><code>papermill --help</code></pre>

    <i><h4> 3. Install Jupyter Notebook (If Not Already Installed)</h4></i>
    <p>Papermill works with Jupyter Notebooks, so make sure Jupyter is installed:</p>
    <pre><code>pip install notebook</code></pre>
    
    <i><h4> 4. Running a Jupyter Notebook with Papermill</h4></i>
    <p>Once installed, you can use Papermill to execute a notebook from the command line:</p>
    <pre><code>papermill input_notebook.ipynb output_notebook.ipynb -p param_name param_value</code></pre>
    
    <p>Example: Running a notebook while setting a parameter</p>
    <pre><code>papermill my_notebook.ipynb output.ipynb -p num_epochs 10</code></pre>
    
    <i><h4> 5. Using Papermill in a Python Script</h4></i>
    <p>You can also run Papermill inside a Python script:</p>
    <pre><code>import papermill as pm

pm.execute_notebook(
    "input_notebook.ipynb",
    "output_notebook.ipynb",
    parameters={"num_epochs": 10, "learning_rate": 0.01}
)</code></pre>

    <p>Now you have Papermill installed and ready to use! </p>
    </section>

    <section id="key-features">
        <h2>Key Features</h2>
        <p>Papermill is a powerful tool that allows for automation and parameterization of Jupyter Notebooks. Below are its key functionalities:</p>
        
        <i><h4>1. Parameterization of Notebooks</h4></i>
        <p><strong>What it does:</strong> Papermill allows users to pass parameters into a Jupyter Notebook at runtime, enabling dynamic execution with different inputs.</p>
        <p><strong>How it works:</strong> A notebook can contain a specially tagged cell (usually marked as "parameters" in Jupyter) where variables are defined. Papermill can override these variables at execution time.</p>
        <p><strong>Why it's useful:</strong></p>
        <ul>
            <li>Eliminates the need for manually editing a notebook to change input values.</li>
            <li>Enables dynamic workflows and experimentation with different configurations.</li>
            <li>Supports automation in machine learning and data processing pipelines.</li>
        </ul>
        <p><strong>Example Usage:</strong></p>
        <pre><code># This cell is tagged as "parameters" in Jupyter
alpha = 0.1
beta = 0.5</code></pre>
        <p>Running the notebook with different parameters using Papermill:</p>
        <pre><code>papermill input_notebook.ipynb output_notebook.ipynb -p alpha 0.2 -p beta 0.7</code></pre>
        
        <i><h4>2. Execution of Notebooks</h4></i>
        <p><strong>What it does:</strong> Papermill automates the execution of Jupyter Notebooks programmatically.</p>
        <p><strong>How it works:</strong> It runs the notebook in a clean execution environment, executing each cell sequentially from top to bottom.</p>
        <p><strong>Why it's useful:</strong></p>
        <ul>
            <li>Automates repetitive analysis tasks.</li>
            <li>Allows scheduling and running notebooks in batch jobs.</li>
            <li>Ensures reproducibility and consistency in data workflows.</li>
        </ul>
        <p><strong>Example Usage:</strong></p>
        <pre><code>papermill input_notebook.ipynb output_notebook.ipynb</code></pre>
        
        <i><h4>3. Recording Notebook Metadata</h4></i>
        <p><strong>What it does:</strong> Papermill records execution metadata, including runtime parameters, execution duration, and timestamps.</p>
        <p><strong>How it works:</strong> When a notebook is executed, metadata is embedded in its JSON structure. This metadata can be inspected later to track how a notebook was executed.</p>
        <p><strong>Why it's useful:</strong></p>
        <ul>
            <li>Helps with debugging and understanding past executions.</li>
            <li>Tracks parameter values used in different runs.</li>
            <li>Enables logging and monitoring of notebook executions.</li>
        </ul>

        <i><h4>4. Error Handling and Checkpointing</h4></i>
        <p><strong>What it does:</strong> Papermill captures errors that occur during execution and preserves partial execution states.</p>
        <p><strong>How it works:</strong> If an error occurs, Papermill stops execution but keeps the notebook intact with executed cells up to the failure point.</p>
        <p><strong>Why it's useful:</strong></p>
        <ul>
            <li>Provides visibility into execution failures without losing progress.</li>
            <li>Useful for debugging long-running jobs.</li>
            <li>Allows restarting from the last successful cell.</li>
        </ul>
        <p><strong>Example Usage:</strong></p>
        <pre><code>papermill input_notebook.ipynb output_notebook.ipynb --log-output</code></pre>
        
        <i><h4>5. Integration with Data Pipelines</h4></i>
        <p><strong>What it does:</strong> Papermill integrates with workflow orchestration tools like Apache Airflow, Kubeflow, and AWS Step Functions.</p>
        <p><strong>How it works:</strong> It allows notebooks to be treated as reusable components in larger data pipelines.</p>
        <p><strong>Why it's useful:</strong></p>
        <ul>
            <li>Enables seamless automation and scheduling of data science workflows.</li>
            <li>Supports cloud-based execution in platforms like AWS, GCP, and Azure.</li>
            <li>Works well with CI/CD pipelines in machine learning.</li>
        </ul>
        
        <i><h4>6. Storage and Remote Execution</h4></i>
        <p><strong>What it does:</strong> Papermill supports reading and writing notebooks from various storage systems and executing notebooks on remote servers.</p>
        <p><strong>How it works:</strong> It can read and write notebooks from:</p>
        <ul>
            <li>Local files</li>
            <li>S3 (Amazon Simple Storage Service)</li>
            <li>Google Cloud Storage</li>
            <li>Azure Blob Storage</li>
            <li>Databases</li>
        </ul>
        <p>It can also execute notebooks remotely on:</p>
        <ul>
            <li>JupyterHub</li>
            <li>Kubernetes</li>
            <li>Cloud-based environments</li>
        </ul>
        <p><strong>Why it's useful:</strong></p>
        <ul>
            <li>Enables scalable execution in distributed systems.</li>
            <li>Supports cloud-based data science workflows.</li>
        </ul>
        <p><strong>Example Usage:</strong></p>
        <pre><code>papermill s3://my-bucket/input_notebook.ipynb s3://my-bucket/output_notebook.ipynb</code></pre>
       
        <i><h4>7. Output and Result Management</h4></i>
        <p><strong>What it does:</strong> Papermill saves executed notebooks with results and outputs.</p>
        <p><strong>How it works:</strong> After execution, the modified notebook is stored with:</p>
        <ul>
            <li>Updated parameter values</li>
            <li>Executed outputs (charts, tables, logs)</li>
            <li>Metadata</li>
        </ul>
        <p><strong>Why it's useful:</strong></p>
        <ul>
            <li>Keeps a historical record of different executions.</li>
            <li>Enables versioning and comparison of results.</li>
        </ul>
    </section>

    <section id="code-examples">
        <h2>Code Examples: Working with Papermill</h2>
        <p>Below is an example of how to use Papermill for automating Jupyter Notebooks.</p>

        Firstly ensure you have papermill installed by running the following command in your terminal:
        <pre><code>pip install papermill</code></pre>
<br>
        Now create a jupyter notebook and import papermill as shown below:
        <script src="https://gist.github.com/guransh0925/f121e10b1afa9b007d8ea3abb4124b04.js"></script>
<br>
        Next, create a cell in the notebook and tag it as "parameters" to define the variables you want to parameterize:
        <script src="https://gist.github.com/guransh0925/074bce84ee609eebdd0cfbf72fd0ad21.js"></script>
<br>
        Write the main code in the notebook, using the parameters defined earlier, for example:
        <script src="https://gist.github.com/guransh0925/62e4aef52b94209f2d91ce4b482efb0f.js"></script>
<br>
        Add this code at the end of your notebook to log all different parameter values and the results obtained into one CSV file. This is done because the output notebook will be overwritten and will only contain the last executed parameters.
        <script src="https://gist.github.com/guransh0925/250c1b51f6f9a08aa0266329c66d2d9e.js"></script>
<br>
        Create an output notebook and then finally, execute the input notebook with different parameter values by running the following command in your terminal:
        <pre><code>papermill input_notebook.ipynb output_notebook.ipynb -p alpha {value1} -p beta {value2}</code></pre>
<br>
        Attached below are screenshots of what your output notebook and CSV file will look like after running the commands:
        <pre><code>papermill input_notebook.ipynb output_notebook.ipynb -p alpha 1 -p beta 1</code></pre>
        <pre><code>papermill input_notebook.ipynb output_notebook.ipynb -p alpha 2 -p beta 2</code></pre>
        <pre><code>papermill input_notebook.ipynb output_notebook.ipynb -p alpha 3 -p beta 3</code></pre>
        <br><i><p>Output Notebook</p></i>
        <img src="https://raw.githubusercontent.com/guransh0925/papermill-blog/main/images/output_nb.png" alt="Output Notebook" style="width: 80%; height: auto;">
        <br>
        <i><p>CSV File</p></i>
        <img src="https://raw.githubusercontent.com/guransh0925/papermill-blog/main/images/executionlog.png" alt="Execution Log" style="width: 80%; height: auto;">

    </section>
    
    <section id="screenshots">
        <h2>Screenshots</h2>
        <p>Below are some screenshots to illustrate key functionalities of Papermill.</p>
    
        <i><h4>1. Running Papermill in Command Line</h4></i>
        <p>Input Notebook: papermill_demo.ipynb</p>
        <p>Output Notebook: output_notebook.ipynb</p>
        <p>Parameters: alpha, beta</p>

        <img src="https://raw.githubusercontent.com/guransh0925/papermill-blog/main/images/papermill-cli.png" alt="CLI">
        <p>This shows Papermill executing a Jupyter Notebook with parameters.</p>
    
        <i><h4>2. Viewing Execution Metadata</h4></i>
        <img src="https://raw.githubusercontent.com/guransh0925/papermill-blog/main/images/notebook-metadata.png" alt="Notebook metadata">
        <p>Papermill automatically logs execution details for tracking and debugging.</p>
    
        <i><h4>3. Parameterization of Notebooks</h4></i>
        <img src="https://raw.githubusercontent.com/guransh0925/papermill-blog/main/images/parameter-cell.png" alt="Output Notebook">
        <p>This shows a Jupyter Notebook cell tagged as "parameters" with variables defined.</p>
    
        <i><h4>4. Error Handling and Checkpointing</h4></i>
        <img src="https://raw.githubusercontent.com/guransh0925/papermill-blog/main/images/error-handling.png" alt="Error Handling" >
        <p>This shows a notebook with an error during execution and the cells executed up to the failure point.</p>
    
        <i><h4>5. Output and Result Management</h4></i>
        <img src="https://raw.githubusercontent.com/guransh0925/papermill-blog/main/images/output_nb.png" alt="Output Notebook">
        <p>This shows an executed notebook with updated parameter values and outputs.</p>
    </section>
    
    <section id="use-cases">
        <h2>Use Cases: Where is Papermill Useful?</h2>
        <p>Papermill is widely used in various domains to automate Jupyter Notebooks.</p>
        <ol>
             <strong><li>Data Science:</strong> Papermill allows data scientists to run the same notebook with different datasets by passing parameters at runtime. This helps in comparing results across multiple datasets without manually changing the notebook.</li>
             <strong><li>Machine Learning:</strong> Papermill can be used to automate the process of hyperparameter tuning by running the notebook multiple times with different parameter values. This is useful for training machine learning models with various configurations to find the best performing model.</li>
             <strong><li>Reporting & Dashboards:</strong> Papermill can automate the generation of reports by running notebooks with updated data. This is useful for creating daily, weekly, or monthly reports without manual intervention.</li>
             <strong><li>ETL Pipelines:</strong> Papermill can be integrated into ETL pipelines to automate the process of extracting data from sources, transforming it, and loading it into databases or data warehouses. This ensures that data processing tasks are consistent and reproducible.</li>
             <strong><li>Cloud Deployments:</strong> Papermill supports execution on cloud platforms, making it easy to run notebooks in cloud-based environments. This is useful for leveraging cloud resources for scalable and distributed data processing.</li>
        </ol>
        <p>These use cases highlight the versatility of Papermill in automating and parameterizing Jupyter Notebooks, making it a valuable tool for data scientists, engineers, and analysts.</p>
    </section>
    
    <section id="conclusion">
        <h2>Conclusion</h2>
        <p>Papermill is a powerful and versatile tool that significantly enhances the capabilities of Jupyter Notebooks. By enabling parameterization, automated execution, and detailed execution tracking, Papermill streamlines workflows and boosts productivity for data scientists, engineers, and analysts.</p>
        <p>Whether you are running experiments with different datasets, automating machine learning model training, generating periodic reports, or integrating notebooks into complex data pipelines, Papermill provides the flexibility and scalability needed to handle these tasks efficiently.</p>
        <p>With its support for cloud deployments and various storage systems, Papermill also facilitates seamless integration into modern data science and machine learning environments. By leveraging Papermill, you can save time, ensure reproducibility, and scale your workflows effectively.</p>
        <p>We hope this blog has provided you with a comprehensive understanding of Papermill's key features and use cases. Start exploring Papermill today and unlock the full potential of your Jupyter Notebooks!</p>
    </section>
    
    <section id="references">
        <h2>References & Further Reading</h2>
        <ul>
            <li><a href="https://papermill.readthedocs.io/en/latest/" target="_blank">Official Papermill Documentation</a></li>
            <li><a href="https://github.com/nteract/papermill" target="_blank">Papermill GitHub Repository</a></li>
            <li><a href="https://towardsdatascience.com/parameterized-python-notebooks-with-papermill-620b5d2c34ce" target="_blank">Tutorial on Towards Data Science</a></li>
        </ul>
    </section>
    
</body>
</html>
